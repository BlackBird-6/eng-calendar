<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="styles.css">
    <title>Document</title>
</head>
<body>
  
    <p class="introText">Please note that no physics tutorials or labs will be listed. Because physics tutorial/labs run every week, this should already be part of everyone’s “normal” schedule for the week and hopefully does not need any reminders.
    <br>
    Also, only mandatory assignments with grades attached to them will be listed. This means that, for example, MatLab tutorial sessions for Lin Alg will not be listed.
    <br>
    Note that this calendar can be used as a useful tool, but there is still the possibility that data may have been entered wrong. Make sure to double-check any important dates, (especially if it comes down to the hour)! If you accidentally miss something, I hold no liability for any potential ramifications.
    <br>
    Find a mistake in the due dates? Notice a missing assignment? Have any other concerns/suggestions? Feel free to contact me at blackbird6366@gmail.com!
    </p>

  <div style="display: flex; justify-content: center;">
    <label>Statics Section: </label>
    <select id="staticsDropdown" style="margin-right: 10px;">
      <option value="staticsT004">TUT 004</option>
      <option value="staticsT005">TUT 005</option>
      <option value="staticsT006">TUT 006</option>
      <option value="staticsT007">TUT 007</option>
      <option value="staticsT008">TUT 008</option>
      <option value="staticsT009">TUT 009</option>
      <option value="staticsT010">TUT 010</option>
      <option value="staticsT011">TUT 011</option>
      <option value="staticsT012">TUT 012</option>
      <option value="staticsT013">TUT 013</option>
      <option value="staticsT014">TUT 014</option>
      <option value="staticsT015">TUT 015</option>
  </select>

  <label>Programming Section: </label>
    <select id="programmingDropdown">
      <option value="programmingL003">LAB 004</option>
      <option value="programmingL004">LAB 004</option>
      <option value="programmingL005">LAB 005</option>
      <option value="programmingL006">LAB 006</option>
      <option value="programmingL007">LAB 007</option>
      <option value="programmingL008">LAB 008</option>
  </select>
</div>

  <h2 id="staticsWarn" class="warn">Warning! Statics section not yet selected.</h2>
  <h2 id="programmingWarn" class="warn">Warning! Programming section not yet selected.</h2>
  <h1 id="day">Due Within 48 Hours</h1>
  <table id="eventsDay">
    <thead>
      <tr>
        <th>Date</th>
        <th>Event</th>
        <th>Type</th>
        <th>Major Assessment</th>
        <th>Notes</th>
        <th>Days Left</th>
      </tr>
    </thead>
    <tbody>
      <!-- Data will be appended here -->
    </tbody>
  </table>

  <h1>Due within 1 Week</h1>
  <table id="eventsWeek">
      <thead>
        <tr>
          <th>Date</th>
          <th>Event</th>
          <th>Type</th>
          <th>Major Assessment</th>
          <th>Extra Info</th>
          <th>Days Left</th>
        </tr>
      </thead>
      <tbody>
        <!-- Data will be appended here -->
      </tbody>
    </table>

    <h1>Upcoming Major Assessments</h1>
    <table id="eventsMajor">
      <thead>
        <tr>
          <th>Date</th>
          <th>Event</th>
          <th>Type</th>
          <th>Major Assessment</th>
          <th>Extra Info</th>
          <th>Days Left</th>
        </tr>
      </thead>
      <tbody>
        <!-- Data will be appended here -->
      </tbody>
    </table>
    
    <h1>All Upcoming</h1>
    
    <div class="linkBox">
      <a onclick="toggleVisibility('eventsAll', this)">+ Click to Open</a>
    </div>
    
    <div id="eventsAllContainer" style="display: none;">
      <table id="eventsAll">
        <thead>
          <tr>
            <th>Date</th>
            <th>Event</th>
            <th>Type</th>
            <th>Major Assessment</th>
            <th>Extra Info</th>
            <th>Days Left</th>
          </tr>
        </thead>
        <tbody>
          <!-- Data will be appended here -->
        </tbody>
      </table>
    </div>

    
    <h1>All Completed</h1>
    <div class="linkBox">
      <a onclick="toggleVisibility('eventsCompleted', this)">+ Click to Open</a>
    </div>

    <div id="eventsCompletedContainer" style="display: none;">
      <table id="eventsCompleted">
        <thead>
          <tr>
            <th>Date</th>
            <th>Event</th>
            <th>Type</th>
            <th>Major Assessment</th>
            <th>Extra Info</th>
            <th>Days Left</th>
          </tr>
        </thead>
        <tbody>
          <!-- Data will be appended here -->
        </tbody>
      </table>
    </div>

    <script>
      function toggleVisibility(id, linkId) {
        // Toggle table visibility
        const container = document.getElementById(id + 'Container');
        if (container.style.display === 'none') {
          container.style.display = 'block';
        } else {
          container.style.display = 'none';
        }
        
        // Toggle link visibility
        if (linkId.innerHTML === '+ Click to Open') linkId.innerHTML = '- Click to Collapse';
        else {
          linkId.innerHTML = '+ Click to Open';
        }
      }
      
    </script>
    
    
    <script>
         
    const jsonFilePath = 'assets/events.json';

    // Fetch the JSON data and display it
    fetch(jsonFilePath)
    .then(response => {
        if (!response.ok) {
        throw new Error(`HTTP error! Status: ${response.status}`);
        }
        return response.json();
    })
    .then(data => {

      var currentDate = new Date();
      data.forEach(item => {
        const eventDate = new Date(item.date + 'T00:00:00');
        console.log(eventDate);
        const timeDiff = eventDate - currentDate;
        const daysLeft = Math.ceil(timeDiff / (1000 * 60 * 60 * 24));
        item.daysLeft = daysLeft;
      });

      const tableBodies = [
        document.querySelector('#eventsDay tbody'),
        document.querySelector('#eventsWeek tbody'),
        document.querySelector('#eventsMajor tbody'),
        document.querySelector('#eventsAll tbody'),
        document.querySelector('#eventsCompleted tbody')
      ];
      
      // Populate a row with JSON data
      const addRow = (item, tableBody) => {
        const row = document.createElement('tr');
        row.innerHTML = `
          <td>${item.date}</td>
          <td>${item.name}</td>
          <td>${item.type}</td>
          <td>${item.major}</td>
          <td>${item.notes}</td> 
        `;
        if(item.daysLeft == 0) {
          row.innerHTML += `<td><b>Due Today.</b></td>`;
        }
        else if (item.daysLeft > 0) {
          row.innerHTML += `<td>${item.daysLeft}</td>`;
        }
        else {
          row.innerHTML += `<td>-</td>`;
        }

        if (item.major === "Yes") {
          row.style.backgroundColor = '#ffcccc';
          row.querySelectorAll('td').forEach(item => {
            item.classList.add('majorCell');
          });
        }
        else {
          row.style.backgroundColor = 'white';
          row.querySelectorAll('td').forEach(item => {
            item.classList.add('cell');
          });
        }

        tableBody.appendChild(row);
      }
      
      let staticsSection = "N/A";
      let programmingSection = "N/A";


      document.getElementById("staticsDropdown").addEventListener("change", function () {
        staticsSection = this.value;
        console.log("Selected:", this.value);
        renderItems();
      });

      document.getElementById("programmingDropdown").addEventListener("change", function () {
        programmingSection = this.value;
        console.log("Selected:", this.value);
        renderItems();
      });

      function renderItems() {

        tableBodies.forEach(body => {
          body.innerHTML = '';
        });

        data.forEach(item => {

          if(item.attending != "All" && item.attending != staticsSection && item.attending != programmingSection) {
            return;
          }

          if(item.daysLeft >= 0 && item.daysLeft <= 1) {
            addRow(item, tableBodies[0]);
          }
          if(item.daysLeft >= 2 && item.daysLeft <= 7) {
            addRow(item, tableBodies[1]);
          }
          if(item.major === "Yes") {
            addRow(item, tableBodies[2]);
          }

          if(item.daysLeft >= 0) {
              addRow(item, tableBodies[3]);
          }

          if(item.daysLeft < 0) {
            addRow(item, tableBodies[4]);
          }
        });
      }

      renderItems();

    })
    .catch(error => {
        console.error('Error fetching or parsing JSON:', error);
    });

    

    </script>
</body>
</html>