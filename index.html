<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="styles.css">
    <title>Document</title>
</head>
<body>

    <h2 class="introText">General 1st Year Engineering Calendar</h2>
    <h3 class="introText">by BlackBird_6</h3>
    <p class="introText">Hello! This calendar is designed to help you keep track of important dates and deadlines for your first year engineering courses. It is recommended that you select your course cohort and respective course sections to filter out events that are not relevant to you. The calendar will automatically update to show you what is due within the next 48 hours, within the next week, and any upcoming major assessments. You can also view all upcoming events or all completed events.
    <br/>
    <br/>
    Please note that no physics tutorials or labs will be listed. Because physics tutorial/labs run every week, this should already be part of your “normal” schedule for the week and hopefully does not need any reminders.
    Also, only mandatory assignments with grades attached to them will be listed. This means that, for example, tutorial sections will not be listed, even if showing up to them may be helpful.
    <br/>
    <br/>
    Note that this calendar can be used as a useful tool, but there is still the possibility that data may be inaccurate. Make sure to double-check any important dates, (especially if it comes down to the last minute)! If you accidentally miss anything important, I hold no liability for any potential consequences or ramifications.
    <br/>
    <br/>
    Find a mistake in the calendar? Notice anything missing? Have any other concerns or suggestions? Feel free to contact me at blackbird6366@gmail.com!
    </p>

    <hr>
    <br/>

  <div class="flexContainer">

    <label>Select Cohort: </label>
    <select id="cohortDropdown" style="margin-right: 10px;">
      <option disabled selected value>-</option>
      <option value="cohortA">Chemistry + Materials</option>
      <option value="cohortB">Linear Algebra + Programming</option>
    </select>
  </div>
  
  <br/>
  <h2 id="cohortWarn" class="warn">Warning! Cohort not yet selected.</h2>
  
  <div id="courseDropdowns" class="flexContainer" style="display: none;">
    <label>Statics Section: </label>
    <select id="staticsDropdown" style="margin-right: 10px;">
      <option disabled selected value>-</option>
      <option value="staticsT004">TUT 004</option>
      <option value="staticsT005">TUT 005</option>
      <option value="staticsT006">TUT 006</option>
      <option value="staticsT007">TUT 007</option>
      <option value="staticsT008">TUT 008</option>
      <option value="staticsT009">TUT 009</option>
      <option value="staticsT010">TUT 010</option>
      <option value="staticsT011">TUT 011</option>
      <option value="staticsT012">TUT 012</option>
      <option value="staticsT013">TUT 013</option>
      <option value="staticsT014">TUT 014</option>
      <option value="staticsT015">TUT 015</option>
  </select>

  <div id="chemSelect">
    <label>Chemistry Section: </label>
      <select id="chemDropdown" style="margin-right: 10px;">
        <option disabled selected value>-</option>
        <option value="chemLO">Ends in ODD number</option>
        <option value="chemLE">Ends in EVEN number</option>
    </select>
  </div>

  <div class="programmingSelect">
    <label>Programming Section: </label>
      <select id="programmingDropdown" style="margin-right: 10px;">
        <option disabled selected value>-</option>
        <option value="programmingL003">LAB 003</option>
        <option value="programmingL004">LAB 004</option>
        <option value="programmingL005">LAB 005</option>
        <option value="programmingL006">LAB 006</option>
        <option value="programmingL007">LAB 007</option>
        <option value="programmingL008">LAB 008</option>
    </select>
  </div>
  
</div>

<div class="flexContainer">
  <label>Increase Stress: </label>
  <input type="checkbox" id="renderSeconds">
</div>

  <h2 id="staticsWarn" class="warn" style="display: none;">Warning! Statics section not yet selected.</h2>
  <h2 id="programmingWarn" class="warn" style="display: none;">Warning! Programming section not yet selected.</h2>
  <h2 id="chemWarn" class="warn" style="display: none;">Warning! Chemistry section not yet selected.</h2>

  <h1 id="day">Due Within 48 Hours</h1>
  <table id="eventsDay">
    <thead>
      <tr>
        <th>Date</th>
        <th>Event</th>
        <th>Type</th>
        <th>Major Assessment</th>
        <th>Notes</th>
        <th>Time Left</th>
      </tr>
    </thead>
    <tbody>
      <!-- Data will be appended here -->
    </tbody>
  </table>

  <h1>Due Within 1 Week</h1>
  <table id="eventsWeek">
      <thead>
        <tr>
          <th>Date</th>
          <th>Event</th>
          <th>Type</th>
          <th>Major Assessment</th>
          <th>Extra Info</th>
          <th>Time Left</th>
        </tr>
      </thead>
      <tbody>
        <!-- Data will be appended here -->
      </tbody>
    </table>

    <h1>Upcoming Major Assessments</h1>
    <table id="eventsMajor">
      <thead>
        <tr>
          <th>Date</th>
          <th>Event</th>
          <th>Type</th>
          <th>Major Assessment</th>
          <th>Extra Info</th>
          <th>Time Left</th>
        </tr>
      </thead>
      <tbody>
        <!-- Data will be appended here -->
      </tbody>
    </table>
    
    <h1>All Upcoming</h1>
    
    <div class="linkBox">
      <a onclick="toggleVisibility('eventsAll', this)">+ Click to Open</a>
    </div>
    
    <div id="eventsAllContainer" style="display: none;">
      <table id="eventsAll">
        <thead>
          <tr>
            <th>Date</th>
            <th>Event</th>
            <th>Type</th>
            <th>Major Assessment</th>
            <th>Extra Info</th>
            <th>Time Left</th>
          </tr>
        </thead>
        <tbody>
          <!-- Data will be appended here -->
        </tbody>
      </table>
    </div>

    
    <h1>All Completed</h1>
    <div class="linkBox">
      <a onclick="toggleVisibility('eventsCompleted', this)">+ Click to Open</a>
    </div>

    <div id="eventsCompletedContainer" style="display: none;">
      <table id="eventsCompleted">
        <thead>
          <tr>
            <th>Date</th>
            <th>Event</th>
            <th>Type</th>
            <th>Major Assessment</th>
            <th>Extra Info</th>
            <th>Time Left</th>
          </tr>
        </thead>
        <tbody>
          <!-- Data will be appended here -->
        </tbody>
      </table>
    </div>

    <script>
      function toggleVisibility(id, linkId) {
        // Toggle table visibility
        const container = document.getElementById(id + 'Container');
        if (container.style.display === 'none') {
          container.style.display = 'block';
        } else {
          container.style.display = 'none';
        }
        
        // Toggle link visibility
        if (linkId.innerHTML === '+ Click to Open') linkId.innerHTML = '- Click to Collapse';
        else {
          linkId.innerHTML = '+ Click to Open';
        }
      }
      
    </script>
    
    
    <script>
         
    const jsonFilePath = 'assets/events.json';
    let stressMode = false;

    // Fetch the JSON data and display it
    fetch(jsonFilePath)
    .then(response => {
        if (!response.ok) {
        throw new Error(`HTTP error! Status: ${response.status}`);
        }
        return response.json();
    })
    .then(data => {
      updateDaysLeft();

      const tableBodies = [
        document.querySelector('#eventsDay tbody'),
        document.querySelector('#eventsWeek tbody'),
        document.querySelector('#eventsMajor tbody'),
        document.querySelector('#eventsAll tbody'),
        document.querySelector('#eventsCompleted tbody')
      ];
      
      // Populate a row with JSON data
      const addRow = (item, tableBody) => {
        const row = document.createElement('tr');
        row.innerHTML = `
          <td>${item.date}</td>
          <td>${item.name}</td>
          <td>${item.type}</td>
          <td>${item.major}</td>
          <td>${item.notes}</td> 
        `;
        if(item.daysLeft == 0) {
          row.innerHTML += `<td><b>Due Today.</b><br/>${item.hoursLeft} hours</td>`;
          row.querySelectorAll('td').forEach(item => {
            item.classList.add('timedCell');
          });
        }
        else if (item.daysLeft > 0) {
          row.innerHTML += `<td>${item.timeLeft}</td>`;
        }
        else {
          row.innerHTML += `<td>-</td>`;
        }

        if (item.major === "Yes") {
          row.style.backgroundColor = '#ffcccc';
          row.querySelectorAll('td').forEach(item => {
            item.classList.add('majorCell');
          });
        }
        else {
          row.style.backgroundColor = 'white';
          row.querySelectorAll('td').forEach(item => {
            item.classList.add('cell');
          });
        }

        tableBody.appendChild(row);
      }
      
      let staticsSection = "N/A";
      let chemSection = "N/A";
      let programmingSection = "N/A";
      let cohort = "N/A";

      const programmingSelect = document.querySelector('.programmingSelect');
      const chemSelect = document.getElementById('chemSelect');
      
      document.getElementById("cohortDropdown").addEventListener("change", function () {
        cohortWarn.style.display = "none";
        cohort = this.value;
        
        courseDropdowns.style.display = "flex";

        if(staticsSection == "N/A") {
          staticsWarn.style.display = "block";
        }

        // Hide all elements relating to the other cohort and show all elements relating to this cohort
        if(cohort == "cohortA") {
          chemSelect.style.display = "block";

          programmingSelect.style.display = "none";
          programmingSection = "N/A"
          programmingDropdown.selectedIndex = 0;
          programmingWarn.style.display = "none";
          
          if(chemSection == "N/A") {
            chemWarn.style.display = "block";
          }

        }
        
        if(cohort == "cohortB") {
          programmingSelect.style.display = "block";
          
          chemSelect.style.display = "none";
          chemWarn.style.display = "none";
          chemSection = "N/A"
          chemDropdown.selectedIndex = 0;
          
          if(programmingSection == "N/A") {
            programmingWarn.style.display = "block";
          }

        }

        renderItems();
      });

      document.getElementById("chemDropdown").addEventListener("change", function () {
        chemWarn.style.display = "none";
        chemSection = this.value;
        renderItems();
      })

      document.getElementById("staticsDropdown").addEventListener("change", function () {
        staticsWarn.style.display = "none";
        staticsSection = this.value;
        renderItems();
      });

      document.getElementById("programmingDropdown").addEventListener("change", function () {
        programmingWarn.style.display = "none";
        programmingSection = this.value;
        renderItems();
      });

      document.getElementById("renderSeconds").addEventListener("change", function () {
        stressMode = this.checked;
        renderItems();
      })
      
      

      function updateDaysLeft() {
        data.forEach(item => {

          // var currentDate = new Date('2025-01-29 9:00:01');
          var currentDate = new Date();

          const eventDate = new Date(item.date + " " + item.time);
          // console.log(eventDate);
          const timeDiff = eventDate - currentDate;

          item.daysLeft = Math.floor(timeDiff / (1000 * 60 * 60 * 24));
          item.hoursLeft = Math.floor(timeDiff / 1000 / 60 / 60);
          
          if (stressMode == true) {
            let secondsLeft = Math.ceil(timeDiff / 1000) % 60;
            let minutesLeft = Math.floor(timeDiff / 1000 / 60) % 60;
            let hoursLeft = Math.floor(timeDiff / 1000 / 60 / 60) % 24;
            let daysLeft = Math.floor(timeDiff / 1000 / 60 / 60 / 24);

            if (daysLeft <= 9) {
              daysLeft = "0" + daysLeft;
            }
            if (hoursLeft <= 9) {
              hoursLeft = "0" + hoursLeft;
            }
            if (minutesLeft <= 9) {
              minutesLeft = "0" + minutesLeft;
            }
            if (secondsLeft <= 9) {
              secondsLeft = "0" + secondsLeft;
            }
            
            item.timeLeft = `${daysLeft}:${hoursLeft}:${minutesLeft}:${secondsLeft}`
          }
          else {
            item.timeLeft = `${item.daysLeft} days`;
          }
       });
      }
      
      // Check if the user is attending the section related to the item
      function checkAttendance(item) {
        if(item.attending == "All" 
          || item.attending == cohort 
          || item.attending == staticsSection 
          || item.attending == programmingSection
          || item.attending == chemSection) {
            return true;
          }
        else return false;
      }

      function renderItems() {

        tableBodies.forEach(body => {
          body.innerHTML = '';
        });
        
        updateDaysLeft()

        data.forEach(item => {
          
          // If you are not attending the section related to this item, skip it.
          if(checkAttendance(item) == false) {
            return;
          }
          
          // Add item to respective table
          if(item.hoursLeft >= 0 && item.hoursLeft < 48) {
            addRow(item, tableBodies[0]);
          }
          if(item.hoursLeft >= 48 && item.hoursLeft < 168) {
            addRow(item, tableBodies[1]);
          }
          if(item.daysLeft >= 0 && item.daysLeft <= 31 && item.major === "Yes") {
            addRow(item, tableBodies[2]);
          }

          if(item.hoursLeft >= 0) {
              addRow(item, tableBodies[3]);
          }

          if(item.hoursLeft < 0) {
            addRow(item, tableBodies[4]);
          }
        });

        tableBodies.forEach(body => {
          if(body.innerHTML === "") {
            body.innerHTML = "<tr><td colspan='6' style='font-style: italic; background-color: #f0fff0;'>There are no upcoming events! Enjoy it while it lasts...</td></tr>";

          }
        })

        if(stressMode) {
          clearTimeout(renderItems);
          setTimeout(renderItems, 1000);
        }
      }

      renderItems();

    })
    .catch(error => {
        console.error('Error fetching or parsing JSON:', error);
    });

    

    </script>
</body>
</html>